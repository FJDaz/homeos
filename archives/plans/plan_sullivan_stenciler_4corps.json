{
  "task_id": "sullivan_stenciler_4corps_interactive",
  "description": "G√©n√©ration interactive du Stenciler Sullivan - Interface de pr√©visualisation et drill-down des 4 Corps avec progression du niveau de d√©tail",
  "metadata": {
    "created_at": "2026-02-11T04:00:00Z",
    "claude_version": "claude-code",
    "project_context": "Sullivan - √âtape 8 du parcours UX (Validation Composants) - Mode Stenciler avec 4 corps horizontaux",
    "workflow_mode": "FRD-FULL",
    "execution_command": "aetherflow -ff plan_sullivan_stenciler_4corps.json",
    "kimi_role": "CHEF FRONTEND - Expert UI/UX pour interfaces progressives",
    "dialogue_required": true,
    "input_files": [
      "docs/02-sullivan/Genome_Enrichi/Genome_OPTIMISE_2026-02-06/genome_inferred_kimi_innocent_v2.json",
      "Backend/Prod/sullivan/library/elite_components/*.json",
      "Backend/Prod/sullivan/pregenerated_components.json",
      "docs/02-sullivan/Composants/STRATEGIE HYBRIDES DE PREGENRATION DES COMPOSANTS.md"
    ]
  },
  "pre_generation_dialogue": {
    "phase": "DISCOVERY",
    "questions_for_user": [
      {
        "id": "q1_visual_style",
        "question": "Le style 'minimal' a √©t√© choisi. Souhaitez-vous des variations typographiques particuli√®res ? (Inter, Geist, System fonts ?)",
        "context": "J'ai vu que pregenerated_components.json contient d√©j√† des composants 'minimal'. Je veux m'assurer de respecter vos pr√©f√©rences exactes."
      },
      {
        "id": "q2_corps_priority",
        "question": "Parmi les 4 corps (Brainstorm/Backend/Frontend/Deploy), y en a-t-il un que vous voulez voir en priorit√© ou avec plus de d√©tails ?",
        "context": "Pour optimiser le rendu initial, je peux pr√©-charger plus de d√©tails sur le corps le plus important pour vous."
      },
      {
        "id": "q3_animations",
        "question": "Transitions lors du drag & drop et du drill-down : smooth & fluides ou instantan√©es (mode performance) ?",
        "context": "Le genome v2 contient 32 composants. Avec animations, temps de rendu ~300ms. Sans animations, ~50ms."
      },
      {
        "id": "q4_tarmac_layout",
        "question": "Le tarmac (zone de travail) : voulez-vous une grille d'alignement visible ou un canvas libre ?",
        "context": "Pour le drag & drop des corps, je peux ajouter une grille magn√©tique (snap) ou laisser le positionnement libre."
      },
      {
        "id": "q5_elite_components_usage",
        "question": "Les 66 composants Elite : dois-je tous les charger en m√©moire au d√©marrage ou lazy-load au drill-down niveau 4 ?",
        "context": "Strat√©gie hybride Tier 1: 0ms cache vs lazy-load √©conomise la m√©moire mais ajoute 50-100ms au premier drill-down."
      }
    ],
    "wait_for_answers": true,
    "timeout_minutes": 15
  },
  "steps": [
    {
      "id": "step_1",
      "description": "PHASE DIALOGUE - Questions pr√©-g√©n√©ration et collecte des pr√©f√©rences utilisateur",
      "type": "analysis",
      "complexity": 0.1,
      "estimated_tokens": 500,
      "dependencies": [],
      "validation_criteria": [
        "Les 5 questions ont √©t√© pos√©es",
        "L'utilisateur a r√©pondu (ou timeout apr√®s 15min)",
        "Les r√©ponses sont stock√©es pour les steps suivants"
      ],
      "context": {
        "language": "markdown",
        "framework": "interactive-cli"
      }
    },
    {
      "id": "step_2",
      "description": "NIVEAU 0 - G√©n√©ration des 4 Corps en mode preview (20% taille) align√©s horizontalement avec organes visibles mais sans cellules ni atomes",
      "type": "code_generation",
      "complexity": 0.7,
      "estimated_tokens": 3500,
      "dependencies": ["step_1"],
      "validation_criteria": [
        "4 cartes Corps g√©n√©r√©es depuis n0_phases du genome v2",
        "Chaque Corps affiche son n0.name et n0.description",
        "Organes (n1_sections) visibles en blocks color√©s simplifi√©s",
        "Pas de d√©tails n2/n3 (features/components)",
        "Taille 20% de la taille finale desktop",
        "Layout flex-row avec gap de 24px",
        "Style 'minimal' appliqu√© (couleurs, typographie, espacements)",
        "Draggable vers le tarmac avec feedback visuel (cursor grab)"
      ],
      "context": {
        "files": [
          "docs/02-sullivan/Genome_Enrichi/Genome_OPTIMISE_2026-02-06/genome_inferred_kimi_innocent_v2.json"
        ],
        "input_files": [
          "Backend/Prod/sullivan/pregenerated_components.json"
        ],
        "language": "html",
        "framework": "htmx",
        "design_system": "minimal",
        "ux_pattern": "preview-cards-with-drag",
        "notes": [
          "Les 4 Corps = les 4 n0_phases du genome : Brainstorm, Backend, Frontend, Deploy",
          "Mode preview = structure visible SANS d√©tails des cellules (n3_components) ni atomes Elite",
          "Appliquer le style 'minimal' √† TOUS les niveaux (pas juste les atomes)",
          "Chaque Corps doit avoir un data-corps-id pour le tracking"
        ]
      }
    },
    {
      "id": "step_3",
      "description": "NIVEAU 1 - Zone Tarmac et gestion Drag & Drop avec redimensionnement Corps √† 1/3 taille et chargement progressif des organes",
      "type": "code_generation",
      "complexity": 0.8,
      "estimated_tokens": 4200,
      "dependencies": ["step_2"],
      "validation_criteria": [
        "Zone tarmac centr√©e avec bordure dash (indiquer drop zone)",
        "Drag & drop fonctionnel depuis preview vers tarmac",
        "Au drop: Corps passe de 20% √† 33% de taille desktop",
        "Au drop: Le syst√®me commence √† charger les d√©tails des organes (n1_sections avec n2_features)",
        "Feedback visuel pendant le drag (ghost + outline sur tarmac)",
        "Corps sur tarmac devient cliquable pour drill-down",
        "Animation smooth de resize (300ms) ou instantan√©e selon pr√©f√©rence utilisateur"
      ],
      "context": {
        "files": [
          "docs/02-sullivan/Genome_Enrichi/Genome_OPTIMISE_2026-02-06/genome_inferred_kimi_innocent_v2.json"
        ],
        "language": "html",
        "framework": "htmx",
        "interaction_pattern": "drag-drop-with-resize",
        "notes": [
          "Tarmac = zone de travail principale o√π on assemble le layout final",
          "Drag & drop: Corps passe √† 1/3 de taille (PAS 100%, trop gros)",
          "D√©but du chargement Tier 2 (organes d√©taill√©s mais pas encore cellules compl√®tes)"
        ]
      }
    },
    {
      "id": "step_4",
      "description": "NIVEAU 2 - Double-clic sur Corps = Entr√©e dans le Corps avec organes (n1_sections) d√©taill√©s et features (n2) visibles mais cellules (n3) simplifi√©es",
      "type": "code_generation",
      "complexity": 0.9,
      "estimated_tokens": 5500,
      "dependencies": ["step_3"],
      "validation_criteria": [
        "Double-clic sur Corps ‚Üí Vue interne du Corps en plein √©cran",
        "Breadcrumb affich√© : Phase > Corps (ex: Frontend > n1_layout)",
        "Organes (n1_sections) affich√©s en cartes d√©taill√©es avec n2_features visibles",
        "Features (n2) affich√©es en liste avec ic√¥nes mais sans d√©tails complets des composants (n3)",
        "Bouton 'Zoom Out' / '‚Üê Retour' pour revenir au tarmac",
        "Chaque organe cliquable pour drill-down niveau 3",
        "Style 'minimal' maintenu (coh√©rence visuelle)"
      ],
      "context": {
        "files": [
          "docs/02-sullivan/Genome_Enrichi/Genome_OPTIMISE_2026-02-06/genome_inferred_kimi_innocent_v2.json"
        ],
        "language": "html",
        "framework": "htmx",
        "navigation_pattern": "drill-down-with-breadcrumb",
        "notes": [
          "Vue interne = on 'entre' dans le Corps",
          "Organes d√©taill√©s mais cellules simplifi√©es (pas encore tous les n3_components)",
          "Navigation avec breadcrumb pour ne pas se perdre"
        ]
      }
    },
    {
      "id": "step_5",
      "description": "NIVEAU 3 - Double-clic sur Organe = Vue d√©taill√©e des cellules (n3_components) avec mapping vers composants Elite",
      "type": "code_generation",
      "complexity": 0.95,
      "estimated_tokens": 6800,
      "dependencies": ["step_4"],
      "validation_criteria": [
        "Double-clic sur organe (n1_section) ‚Üí Vue d√©taill√©e des features (n2) et composants (n3)",
        "Breadcrumb: Phase > Corps > Organe > Composant",
        "Tous les n3_components affich√©s en cartes d√©taill√©es",
        "Chaque n3_component mapp√© vers un composant Elite de la library",
        "Affichage: endpoint, m√©thode, visual_hint, interaction_type",
        "Boutons Garder/R√©serve sur chaque composant (mode Stenciler)",
        "Preview du composant Elite correspondant (HTML + CSS inline du style 'minimal')",
        "Lazy-load des 66 composants Elite au besoin (ou pr√©-charg√©s selon r√©ponse q5)"
      ],
      "context": {
        "files": [
          "docs/02-sullivan/Genome_Enrichi/Genome_OPTIMISE_2026-02-06/genome_inferred_kimi_innocent_v2.json"
        ],
        "input_files": [
          "Backend/Prod/sullivan/library/elite_components/*.json",
          "Backend/Prod/sullivan/pregenerated_components.json"
        ],
        "language": "html",
        "framework": "htmx",
        "tier_strategy": "tier-1-cache-lookup",
        "notes": [
          "Niveau 4 = d√©tails complets avec atomes Elite (les 66 composants)",
          "Mapping n3_component ‚Üí Elite component via visual_hint et interaction_type",
          "Tier 1 cache: lookup 0ms depuis pregenerated_components.json",
          "Mode Stenciler: boutons Garder/R√©serve pour chaque composant (workflow Arbitrage)"
        ]
      }
    },
    {
      "id": "step_6",
      "description": "INT√âGRATION - Contr√¥les de zoom, navigation globale, √©tat session et bouton Suivant vers √©tape 9",
      "type": "code_generation",
      "complexity": 0.6,
      "estimated_tokens": 3200,
      "dependencies": ["step_5"],
      "validation_criteria": [
        "Barre de contr√¥les zoom: ‚Üê Out | üîç Corps ‚ñº | In ‚Üí",
        "Dropdown pour s√©lection rapide d'un Corps sans drill-down",
        "Bouton 'Suivant' (comp_next_button du genome) pour avancer vers √©tape 9",
        "√âtat session sauvegard√©: corps s√©lectionn√©s, niveau zoom, d√©cisions Garder/R√©serve",
        "Indicateur progression: √©tape 8/9 du parcours Sullivan",
        "Gestion erreurs: retour gracieux si composant Elite non trouv√© (fallback Tier 2/3)"
      ],
      "context": {
        "files": [
          "docs/02-sullivan/Genome_Enrichi/Genome_OPTIMISE_2026-02-06/genome_inferred_kimi_innocent_v2.json",
          "docs/02-sullivan/Parcours UX Sullivan.md"
        ],
        "language": "html",
        "framework": "htmx",
        "session_management": "local-storage-or-backend-session",
        "notes": [
          "Contr√¥les zoom pour navigation fluide entre les 4 niveaux",
          "Bouton Suivant d√©clenche endpoint /studio/next/8 (√©tape 8 ‚Üí 9)",
          "√âtat session pour reprendre o√π on en √©tait apr√®s refresh"
        ]
      }
    },
    {
      "id": "step_7",
      "description": "STYLES CSS - G√©n√©ration des styles 'minimal' coh√©rents pour tous les niveaux de zoom avec variables CSS et responsive desktop",
      "type": "code_generation",
      "complexity": 0.5,
      "estimated_tokens": 2800,
      "dependencies": ["step_1", "step_2", "step_3", "step_4", "step_5", "step_6"],
      "validation_criteria": [
        "Fichier CSS global avec variables pour le style 'minimal'",
        "Variables: couleurs primaires, typographie (bas√© sur r√©ponse q1), espacements, bordures",
        "Classes utilitaires: .corps-preview, .corps-tarmac, .corps-drilldown, .organe-card, .component-card",
        "Animations transitions: drag, drop, resize, drill-down (si activ√©es selon q3)",
        "Responsive desktop: min-width 1024px, optimis√© pour √©crans larges",
        "Dark mode optionnel (selon style 'minimal' ou 'dark' si √©tendu)",
        "Style coh√©rent du niveau 0 (preview 20%) au niveau 3 (d√©tails complets)"
      ],
      "context": {
        "input_files": [
          "Backend/Prod/sullivan/pregenerated_components.json"
        ],
        "language": "css",
        "framework": "vanilla-css-with-variables",
        "design_tokens": "minimal-style",
        "notes": [
          "Style 'minimal' s'applique √† TOUS les niveaux",
          "Variables CSS pour faciliter l'adaptation future vers autres styles (corporate, creative, etc.)",
          "Animations conditionnelles bas√©es sur pr√©f√©rence utilisateur (q3)"
        ]
      }
    },
    {
      "id": "step_8",
      "description": "ENDPOINTS HTMX - D√©finition des endpoints backend n√©cessaires et structure des r√©ponses JSON attendues",
      "type": "analysis",
      "complexity": 0.4,
      "estimated_tokens": 2200,
      "dependencies": ["step_6"],
      "validation_criteria": [
        "Liste exhaustive des endpoints requis avec m√©thode HTTP",
        "Structure JSON de chaque r√©ponse document√©e",
        "Mapping endpoints ‚Üí steps du plan",
        "Sp√©cification des param√®tres de requ√™te (path params, query params, body)",
        "Gestion des erreurs 404 (composant non trouv√©), 500 (erreur serveur)",
        "Documentation pour int√©gration backend (Python FastAPI)"
      ],
      "context": {
        "language": "markdown",
        "framework": "documentation",
        "backend_stack": "python-fastapi",
        "endpoints_examples": [
          "GET /studio/stencils/corps/{corps_id} ‚Üí D√©tails d'un corps",
          "GET /studio/stencils/organe/{organe_id} ‚Üí D√©tails d'un organe",
          "GET /studio/stencils/component/{component_id}/elite ‚Üí Mapping vers Elite component",
          "POST /studio/stencils/select ‚Üí Garder/R√©serve un composant",
          "GET /studio/stencils/session ‚Üí √âtat session actuelle",
          "POST /studio/next/8 ‚Üí Valider √©tape 8 et avancer vers √©tape 9"
        ]
      }
    }
  ],
  "execution_notes": {
    "mode_frd_full": {
      "description": "FRD-FULL = KIMI ‚Üí DeepSeek ‚Üí Gemini",
      "phases": [
        "Phase 1 (FRD-FAST): KIMI g√©n√®re le code frontend avec contexte large (128K tokens)",
        "Phase 2 (FRD-TEST): DeepSeek teste la qualit√© et coh√©rence du code",
        "Phase 3 (FRD-REVIEW): Gemini valide l'exp√©rience utilisateur et l'accessibilit√©"
      ],
      "command": "aetherflow -ff plan_sullivan_stenciler_4corps.json",
      "estimated_total_tokens": 28700,
      "estimated_cost_usd": 0.34,
      "estimated_time_minutes": "8-12"
    },
    "kimi_context": {
      "role": "Tu es KIMI, le CHEF FRONTEND de Sullivan. Expert UI/UX pour interfaces progressives.",
      "strengths": [
        "G√©n√©ration de code frontend HTML/CSS/HTMX de haute qualit√©",
        "Compr√©hension profonde des patterns UX (drag & drop, drill-down, progressive disclosure)",
        "Capacit√© √† g√©rer de grands contextes (genome 32 composants + 66 Elite components)",
        "Optimisation des performances frontend (lazy-load, cache strat√©gies)"
      ],
      "context_files_to_load": [
        "genome_inferred_kimi_innocent_v2.json (32 composants, structure n0‚Üín1‚Üín2‚Üín3)",
        "66 Elite components JSON (Backend/Prod/sullivan/library/elite_components/)",
        "pregenerated_components.json (style 'minimal' avec 18 composants Tier 1)",
        "STRATEGIE HYBRIDES DE PREGENRATION DES COMPOSANTS.md (Tier 1/2/3 cache)"
      ],
      "output_format": "HTML5 + HTMX + CSS Vanilla (pas de framework JS lourd)",
      "target_browser": "Desktop moderne (Chrome/Firefox/Safari derni√®res versions)",
      "accessibility": "WCAG 2.1 AA minimum (role, aria-label, keyboard navigation)"
    },
    "user_journey": {
      "start": "User arrive sur page Stenciler (√©tape 8/9 du parcours Sullivan)",
      "step_1": "Voit 4 Corps horizontaux en preview 20% (Brainstorm, Backend, Frontend, Deploy)",
      "step_2": "Drague un Corps vers le tarmac ‚Üí Corps resize √† 1/3 taille",
      "step_3": "Double-clic sur Corps ‚Üí Entre dans le Corps, voit organes d√©taill√©s",
      "step_4": "Double-clic sur Organe ‚Üí Voit cellules (n3_components) avec composants Elite mapp√©s",
      "step_5": "S√©lectionne Garder/R√©serve sur chaque composant (mode Arbitrage)",
      "step_6": "Utilise contr√¥les zoom pour naviguer entre niveaux",
      "step_7": "Clique 'Suivant' ‚Üí Avance vers √©tape 9 (Adaptation/Zoom Atome)",
      "end": "Session sauvegard√©e, pr√™t pour finalisation"
    },
    "tier_strategy_reminder": {
      "tier_1": "0ms - Cache lookup depuis pregenerated_components.json (18 composants 'minimal')",
      "tier_2": "<100ms - Adaptation l√©g√®re des composants Tier 1 au contexte",
      "tier_3": "1-5s - G√©n√©ration custom si composant unique non trouv√© dans Tier 1/2"
    }
  },
  "success_criteria": {
    "functional": [
      "Les 4 Corps s'affichent correctement en preview 20%",
      "Drag & drop fonctionne sans bug",
      "Navigation drill-down fluide sur 4 niveaux",
      "Mapping genome ‚Üí Elite components r√©ussi",
      "Boutons Garder/R√©serve fonctionnels",
      "√âtat session persiste entre actions"
    ],
    "ux": [
      "Interface claire et intuitive",
      "Feedback visuel √† chaque interaction",
      "Temps de r√©ponse <300ms par action",
      "Animations smooth (si activ√©es)",
      "Style 'minimal' coh√©rent sur tous niveaux"
    ],
    "technical": [
      "Code HTML5 valide et s√©mantique",
      "CSS optimis√© avec variables",
      "HTMX correctement utilis√© (hx-get, hx-post, hx-swap, hx-trigger)",
      "Accessibilit√© WCAG 2.1 AA",
      "Compatible desktop moderne"
    ]
  }
}
